package chacha20

import (
	"bytes"
	"testing"
)

func TestValidateChaCha20Matrix(t *testing.T) {
	key := [32]byte{}
	copy(key[:], bytes.Repeat([]byte{0x1}, 32))

	nonce := [12]byte{}
	copy(nonce[:], bytes.Repeat([]byte{0x2}, 12))

	blockCount := [4]byte{}
	copy(blockCount[:], bytes.Repeat([]byte{0x3}, 4))

	foo := createChaCha20Block(key, blockCount, nonce)
	baseValue := [64]byte{0x65, 0x78, 0x70, 0x61, 0x6e, 0x64, 0x20, 0x33, 0x32, 0x2d, 0x62, 0x79, 0x74, 0x65, 0x20, 0x6b, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x3, 0x3, 0x3, 0x3, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2}
	if bytes.Compare(foo[:], baseValue[:]) != 0 {
		t.Error(foo, baseValue, "Should be the same")
	}

}
